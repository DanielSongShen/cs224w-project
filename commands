# gpt5-mini
poetry run python3 scripts/01_parse_data.py --n_samples 1 --backend gpt5-mini --output_dir mini
poetry run python3 scripts/01_1_visualize_tree.py --input_path mini/final.json -o mini -t

# deepseek-v3.2
poetry run python3 scripts/01_parse_data.py --n_samples 1 --backend deepseek-v3.2 --output_dir deepseek
poetry run python3 scripts/01_1_visualize_tree.py --input_path deepseek/final.json -o deepseek/visualizations -t

poetry run python3 scripts/01_parse_data.py --backend deepseek-v3.2 --async --n_samples 500 --output_dir ./data/processed/deepseek/amc-aime
poetry run python scripts/continue_from_step.py --step 4 --input data/processed/deepseek/amc-aime/process3.json --output_dir data/processed/deepseek/amc-aime --backend deepseek-v3.2 --async --batch_size 10

poetry run python scripts/01_parse_data.py --n_samples 500 --backend deepseek-v3.2 --output_dir ./data/processed/deepseek/math
# Balanced dataset
poetry run python scripts/01_parse_data.py \
    --n_samples 500 \
    --sources math \
    --balanced \
    --output_dir ./data/processed/deepseek/math_balanced

# Regrade
poetry run python scripts/00_fix_labels.py --input data/processed/deepseek/math/final.json --output data/processed/deepseek/math/final_regraded.json

# Generate graph dataset
poetry run python src/data/dataset.py data/processed/deepseek/orca-math/final.json --root ./data/processed/deepseek/orca-math

poetry run python src/data/dataset.py data/processed/deepseek/olympiads/final_regraded.json --root ./data/processed/deepseek/olympiads/directed --force-reload --no-reverse-edges
poetry run python src/data/dataset.py data/processed/deepseek/orca-math/final_regraded.json --root ./data/processed/deepseek/orca-math/directed --force-reload --no-reverse-edges
poetry run python src/data/dataset.py data/processed/deepseek/amc-aime/final_regraded.json --root ./data/processed/deepseek/amc-aime/directed --force-reload --no-reverse-edges
poetry run python src/data/dataset.py data/processed/deepseek/combined/final_regraded.json --root ./data/processed/deepseek/combined/directed --force-reload --no-reverse-edges


poetry run python src/data/dataset.py data/processed/deepseek/olympiads/final_regraded.json --root ./data/processed/deepseek/olympiads/undirected --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/orca-math/final_regraded.json --root ./data/processed/deepseek/orca-math/undirected --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/amc-aime/final_regraded.json --root ./data/processed/deepseek/amc-aime/undirected --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/combined/final_regraded.json --root ./data/processed/deepseek/combined/undirected --force-reload


poetry run python src/data/dataset.py data/processed/deepseek/olympiads/final_regraded.json --root ./data/processed/deepseek/olympiads/undirected --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/orca-math/final_regraded.json --root ./data/processed/deepseek/orca-math/undirected --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/amc-aime/final_regraded.json --root ./data/processed/deepseek/amc-aime/undirected/encoder --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/combined/final_regraded.json --root ./data/processed/deepseek/combined/undirected/encoder --force-reload
poetry run python src/data/dataset.py data/processed/deepseek/math/final_regraded.json --root ./data/processed/deepseek/math/undirected/encoder --force-reload

poetry run python src/data/dataset.py data/processed/deepseek/math_balanced/final.json --root ./data/processed/deepseek/math_balanced/undirected/encoder --force-reload



# Training
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/final_regraded_with_rev.pt --output-dir ./outputs/models/hetero_gat --model-type hetero_gat --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/final_regraded_with_rev.pt --output-dir ./outputs/models/simple_gin --model-type simple_gin --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/final_regraded_with_rev.pt --output-dir ./outputs/models/hetero_gin --model-type hetero_gin --log-interval 1

poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt --output-dir ./outputs/models/hetero_gat/encoder --model-type hetero_gat --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt --output-dir ./outputs/models/simple_gin/encoder --model-type simple_gin --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt --output-dir ./outputs/models/hetero_gin/encoder --model-type hetero_gin --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math/undirected/encoder/final_with_rev.pt --output-dir ./outputs/models/math/simple_gin/encoder --model-type simple_gin --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --output-dir ./outputs/models/math_balanced/simple_gin/encoder --model-type simple_gin --log-interval 1



poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --cross-validation --n-folds 5 --output-dir ./outputs/models/simple_gin/cv/math --model-type simple_gin --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --cross-validation --n-folds 5 --output-dir ./outputs/models/hetero_gat/cv/math --model-type hetero_gat --log-interval 1
poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --cross-validation --n-folds 5 --output-dir ./outputs/models/hetero_gat/cv/math --model-type hetero_gin --log-interval 1


poetry run python scripts/02_train_model.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --cross-validation --n-folds 5 --output-dir ./outputs/models/simple_gin/cv/math --model-type simple_gin --log-interval 1


# No node encoder
poetry run python scripts/02_train_model.py \
    --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt \
    --cross-validation --n-folds 5 \
    --output-dir ./outputs/models/simple_gin/cv/no_encoder \
    --model-type simple_gin \
    --no-node-encoder \
    --log-interval 1


# Hyperparameter Sweeps
nohup poetry run python scripts/02_1_hparam_sweeps.py --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt --search-type random --n-trials 10 --models hetero_gat --verbose
nohup poetry run python scripts/02_1_hparam_sweeps.py --pt-file ./data/processed/deepseek/combined/undirected/encoder/final_regraded_with_rev.pt --search-type random --n-trials 10 --models hetero_gin --verbose
poetry run python scripts/02_1_hparam_sweeps.py --pt-file ./data/processed/deepseek/math_balanced/undirected/encoder/final_with_rev.pt --search-type grid --models simple_gin
poetry run python scripts/02_1_hparam_sweeps.py --all-datasets --search-type random --n-trials 50